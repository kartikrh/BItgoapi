# Transaction Builder

## Create Transaction Builder

```javascript
let txBuilder = new prova.TransactionBuilder(prova.networks.rmg);
```

Create a transaction builder object from scratch.

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
network | prova.networks Object | Yes | The chain network



## Obtain Transaction Builder

```javascript
let txHex = '0100000001…ba00000000';
let transaction = prova.Transaction.fromHex(txHex);
let txBuilder = prova.TransactionBuilder.fromTransaction(transaction);
```

Obtain a transaction builder instance based on a transaction instance.

### Method

`TransactionBuilder.fromTransaction()`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
transaction | Transaction | Yes | Instance of a transaction object
network | prova.networks Object | No | The chain network



## Get Transaction

```javascript
let transaction = txBuilder.build();
```

Obtain a transaction instance.

### Method

`transactionBuilder.build()`



## Add Output

```javascript
let destination = 'THkSaYyczf2X3EgGcoxnyNHYsYQpaBNncBRTa3fNxjxqH';
let value = 3850000;
txBuilder.addOutput(destination, value);
```

Add an output to the transaction builder.

### Method

`transactionBuilder.addOutput()`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
destinationAddress | Address | Yes | Address instance of the destination
 | String | | Base58-string representation of the destination address
value | Integer | Yes | Amount in atoms of the value to send



## Add Admin Thread Output

```javascript
txBuilder.addAdminThreadOutput(prova.ADMIN.THREADS.PROVISIONING);
```

Add an output to the transaction builder marking it as an admin transaction by specifying the admin thread.

### Method

`transactionBuilder.addAdminThreadOutput(threadID)`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
threadID | Integer | Yes | Thread ID of the admin transaction. One of `prova.ADMIN.THREADS`



## Add Admin Key Update Output

```javascript
let operation = prova.ADMIN.OPERATIONS.REVOKE_KEY;
let keyType = prova.ADMIN.KEY_TYPES.ROOT.PROVISIONING_KEY;
let publicKey = prova.ECPair.fromPublicKeyBuffer(Buffer.from('025ceeba2a…57d233edf1', 'hex'));
txBuilder.addKeyUpdateOutput(operation, keyType, publicKey);
```

Add admin output to provision or revoke a signing key.

### Method

`transactionBuilder.addKeyUpdateOutput(operation, keyType, publicKey)`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
operation | Integer | Yes | Key operation enum. One of `prova.ADMIN.OPERATIONS`
keyType | Integer | Yes | Key type enum. One of `prova.ADMIN.KEY_TYPES`. Nested
publicKey | Buffer | No | ECPair public or private key material as a Buffer instance
 | HDNode | | HDNode instance
 | String | | Base58-HDNode representation starting with "xpub" or "xprv"
 


## Add Fund Destruction Output

```javascript
let amount = 2400000; // 2.4 grams
txBuilder.addFundDestructionOutput(amount);
```

Add admin output destroying a specified amount of funds.

### Method

`transactionBuilder.addFundDestructionOutput(amount)`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
amount | Integer | Yes | Amount in atoms of the value to send



## Add Input

```javascript
let inputTransaction = prova.Transaction.fromHex('…');
let outputIndex = 2;
txBuilder.addInput(inputTransaction.getId(), outputIndex, 0xffffffff);
```

Add an input to the transaction builder.

### Method

`transactionBuilder.addInput(inputTransactionID, outputIndex, sequence)`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
inputTransactionID | String | Yes | ID of the input's previous output transaction
outputIndex | Integer | Yes | Output index of the input transaction
sequence | Integer | No | Typically `0xffffffff` 



## Sign Input

```javascript
let inputIndex = 0;
let privateKey = hdNode.getKey();
let outputAddress = prova.Address.fromBase58('THkSaYyczf…Ta3fNxjxqH');
let value = 4000000;
txBuilder.sign(inputIndex, privateKey, outputAddress.toScript(), value);
```

Sign a transaction input.

<aside class="notice">Due to <code>SIGHASH_ALL</code>, inputs should only be signed after all outputs are set.</aside>

### Method

`transactionBuilder.sign()`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
inputIndex | Integer | Yes | Input index of the current transaction
privateKey | ECPair | Yes | ECPair private key instance used for signing
outputScript | Buffer | Yes | Script of the previous transaction's output
value | Integer | Yes | Amount in atoms of the spent value



## Simple Sign Input

```javascript
let inputIndex = 0;
let privateKey = hdNode.getKey();
let inputTransaction = prova.Transaction.fromHex('…');
txBuilder.signWtihTx(inputIndex, privateKey, inputTransaction);
```

Sign an input if its previous transaction is available.

<aside class="notice">Due to <code>SIGHASH_ALL</code>, inputs should only be signed after all outputs are set.</aside>

### Method

`transactionBuilder.signWithTx()`

### Arguments

Name | Type | Required | Description
---- | ---- | -------- | -----------
inputIndex | Integer | Yes | Input index of the current transaction
privateKey | ECPair | Yes | ECPair private key instance used for signing
inputTransaction | Transaction | Yes | Transaction whose output is used for the input to be signed 